var e=Object.defineProperty,t=(t,a,s)=>("symbol"!=typeof a&&(a+=""),a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s);import{r as a,B as s,a as n,D as r,b as o,S as l,c as i,d,T as c,e as m,f as y,h,A as u,C as D,g as f,i as p,z as _}from"./vendor.7c1ac94f.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const s=new URL(e,location),n=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,r)=>{const o=new URL(e,s);if(self[t].moduleMap[o])return a(self[t].moduleMap[o]);const l=new Blob([`import * as m from '${o}';`,`${t}.moduleMap['${o}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){r(new Error(`Failed to import: ${e}`)),n(i)},onload(){a(self[t].moduleMap[o]),n(i)}});document.head.appendChild(i)})),self[t].moduleMap={}}}("assets/");const{Option:g}=d,{Text:E}=c;function Y(e){const[t,l]=a.useState(!1);function i(t){e.changeCustomDay(e.customDay.filter((e=>e!==t)))}return a.createElement("div",{style:{position:"absolute",top:"10px",right:"10px"}},a.createElement(s,{shape:"circle",onClick:()=>l(!t)},a.createElement(n,null)),a.createElement(r,{placement:"left",onClose:function(){l(!1)},visible:t,width:"50%"},a.createElement(o,{orientation:"left"},"自定义工作日"),e.customDay.map(((e,t)=>a.createElement(k,{dayData:e,key:t,onDelete:i}))),a.createElement("div",{style:{paddingTop:"6px"}},a.createElement(E,{keyboard:!0,style:{cursor:"pointer"},onClick:function(){e.customDay.push({}),e.changeCustomDay(e.customDay)}},"再添加一个日期")),a.createElement(o,{orientation:"left"},"智能推荐")))}function k(e){const{dayData:t,onDelete:n}=e;return a.createElement(l,{style:{paddingBottom:"5px"}},a.createElement(i,{value:t.date,onChange:function(e){t.date=e}}),a.createElement(d,{value:t.status,style:{width:120},onChange:function(e){t.status=e}},a.createElement(g,{value:"holiday"},"节假日"),a.createElement(g,{value:"workingDay"},"工作日")),a.createElement(s,{type:"primary",danger:!0,onClick:()=>{n(t)}},"删除"))}class M extends a.Component{constructor(e){super(e),t(this,"getHoliday",(e=>{m.get(`//timor.tech/api/holiday/year/${e}/`).then((({data:{holiday:t}})=>{t.year=e,this.setState({holiday:t})}),(()=>{y.error("请求节假日API出错")}))})),t(this,"current"),t(this,"onChange",(e=>{e&&this.state.holiday.year!=e.year()&&this.getHoliday(e.year()),this.setState({startDate:e})})),t(this,"dateFullCellRender",(e=>{const t=this.getDayData(e);return a.createElement("div",{onClick:e=>e.stopPropagation(),className:"holiday-bar-container "+(t.isNonWorkingDay?"is-holiday":"")},a.createElement("div",{className:"holiday-bar-title"},a.createElement("span",{className:"date"},e.format("DD"))),t.inHoliday&&a.createElement("div",{className:`holiday-bar day-${t.diffDays}`}),t&&a.createElement("div",{className:"day-name"},t.name))})),t(this,"headerRender",(({value:e})=>a.createElement("div",{className:"calendar-header"},e.format("YYYY年M月")))),t(this,"message",(()=>{if(!this.state.startDate)return"请输入开始日期";let{workingDays:e,holidayBefore:t,holidayAfter:a}=this.calcHolidays();let s=`包含工作日 ${e} 天，非工作日 ${15-e} 天，`;return t&&(s+=`前拼假 ${t} 天，`),a&&(s+=`后拼假 ${a} 天，`),s+=`共连休 ${15+t+a} 天。 婚假指数为 ${this.holidayIndex(e,t,a)}。`,s})),t(this,"changeCustomDay",(e=>{this.setState({customDay:e})})),this.state={startDate:null,holiday:null,customDay:[{}]}}componentDidMount(){this.getHoliday(h().year())}getDayData(e){const t=this.state.holiday?this.state.holiday[e.format("MM-DD")]:null,a=this.state.startDate&&this.state.startDate.startOf("day").diff(e.startOf("day"),"days"),s="number"==typeof a&&a>-15&&a<=0;let n=6===e.day()||0===e.day();t&&(n=t.holiday);for(let r=0;r<this.state.customDay.length;r++){const t=this.state.customDay[r];t.status&&t.date&&e.isSame(t.date,"day")&&(n="holiday"===t.status)}return{isNonWorkingDay:n,inHoliday:s,diffDays:Math.abs(a)+1,name:t?t.name:""}}calcHolidays(){let e=0,t=0,a=0;for(let s=0;s<15;s++){const t=h(this.state.startDate.toDate()).add(s,"days");this.getDayData(t).isNonWorkingDay||e++}for(;;){const e=h(this.state.startDate.toDate()).add(0-t-1,"days");if(!this.getDayData(e).isNonWorkingDay)break;t++}for(;;){const e=h(this.state.startDate.toDate()).add(a+15,"days");if(!this.getDayData(e).isNonWorkingDay)break;a++}return{workingDays:e,holidayBefore:t,holidayAfter:a}}holidayIndex(e,t,a){return Math.floor(100*(e/15+.02*(t+a)))}render(){return a.createElement("div",{className:"App"},a.createElement(Y,{customDay:this.state.customDay,changeCustomDay:this.changeCustomDay}),a.createElement(l,null,a.createElement(i,{placeholder:"婚假开始日期",inputReadOnly:!0,onChange:this.onChange})),a.createElement("div",{style:{marginTop:16}},a.createElement(u,{message:this.message()})),a.createElement("div",{style:{marginTop:16,padding:"0 5px",backgroundColor:"#fff"}},a.createElement(D,{value:this.state.startDate||h(),dateFullCellRender:this.dateFullCellRender,headerRender:this.headerRender})))}}var v={months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},meridiemParse:/凌晨|早上|上午|中午|下午|晚上/,meridiemHour:function(e,t){return 12===e&&(e=0),"凌晨"===t||"早上"===t||"上午"===t?e:"下午"===t||"晚上"===t?e+12:e>=11?e:e+12},meridiem:function(e,t,a){var s=100*e+t;return s<600?"凌晨":s<900?"早上":s<1130?"上午":s<1230?"中午":s<1800?"下午":"晚上"},calendar:{sameDay:"[今天]LT",nextDay:"[明天]LT",nextWeek:function(e){return e.week()!==this.week()?"[下]dddLT":"[本]dddLT"},lastDay:"[昨天]LT",lastWeek:function(e){return this.week()!==e.week()?"[上]dddLT":"[本]dddLT"},sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(日|月|周)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"日";case"M":return e+"月";case"w":case"W":return e+"周";default:return e}},relativeTime:{future:"%s后",past:"%s前",s:"几秒",ss:"%d 秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",w:"1 周",ww:"%d 周",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},week:{dow:1,doy:4}};h.locale("zh-cn",v),f.render(a.createElement(a.StrictMode,null,a.createElement(p,{locale:_},a.createElement(M,null))),document.getElementById("root"));
